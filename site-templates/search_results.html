
{% extends "base.html" %}
{% load staticfiles %}
{% block content %}
{% load humanize %}
{% load mathfilters %}
{% load render_table from django_tables2 %}
<link href="{% static 'dashboard.css' %}" rel="stylesheet" media="screen">

<body>


    <div class="container-fluid">
        <div class="row">
        
        <div class="col-sm-3 col-md-2 sidebar">
          <ul class="nav nav-sidebar" id="sidenav">
            <li class="active"><a href="#top">Overview</a></li> <!--TODO: active does not move-->
            <li><a href="#estimate_explanation">Estimate Explanation</a></li>
            <li><a href="#recent_sales">Other Recent Sales</a></li>
        <!--<li><a href="#ask_sell">Asking vs Selling Prices*</a></li>
            <li><a href="#">Home's Sales History*</a></li>-->
            <li><a href="#market_temp">Market Temperature*</a></li>
          </ul>
          <ul class="nav nav-sidebar">
            <!--<li><a>Local Scoop</a></li>-->
            <li><a href="#foursquare">Foursquare</a></li>
            <li><a href="#yelp">Yelp</a></li>
            <li><a href="#instagram">Instagram</a></li>
            <li><a href="#twitter">Recent Tweets</a></li>
            <li><a href="#eventful">Events</a></li>
          </ul>
<!--          <ul class="nav nav-sidebar">
            <li><a href="#">Evaluate Neighborhood*</a></li>
            <li><a href="#">Professional Services*</a></li>
          </ul>-->
        </div>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
            <h1 class="page-header" id="top"> Home Estimate Report: {{ subject_home.address |title}} </h1>
          
        <h3>{% if result.estimated_price %}EazyHouz Estimate: ${% endif %}
        {{result.estimated_price | intdiv:1 |floatformat:"0"|intcomma}}</h3>
      <p><strong>Based on {{ result.number_of_homes_used }} closest comparables adjusted sale price:</strong>
		{% if subject_home.last_zestimate %}
		<br>Zestimate: <strong>${{ subject_home.last_zestimate | intcomma }}</strong>
		{% endif %}
        <br><br>
          
          
          
          
          <div class="row placeholders">
            <div class="col-xs-6 col-sm-3 placeholder">
              <img src="{{subject_home.image_url}}" class="img-responsive" alt="Generic placeholder thumbnail">
              <h4>{{subject_home.address}}</h4>
              <span class="text-muted">Subject Property</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <a href="/home/genappraisal/?pid={{ result.home1.id }}"><img src="{{result.home1.image_url}}" class="img-responsive" alt="Generic placeholder thumbnail"></a>
              <a href="/home/genappraisal/?pid={{ result.home1.id }}"><h4>{{ result.home1.address }}</h4></a>
              <span class="text-muted">Comparable #1<br>Last Sale Price: ${{result.home1.sale_price | intcomma}}</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <a href="/home/genappraisal/?pid={{ result.home2.id }}"><img src="{{result.home2.image_url}}" class="img-responsive" alt="Generic placeholder thumbnail"></a>
              <a href="/home/genappraisal/?pid={{ result.home2.id }}"><h4>{{ result.home2.address }}</h4></a>
              <span class="text-muted">Comparable #2<br>Last Sale Price: ${{result.home2.sale_price | intcomma}}</span>
            </div>
            <div class="col-xs-6 col-sm-3 placeholder">
              <a href="/home/genappraisal/?pid={{ result.home3.id }}"><img src="{{result.home3.image_url}}" class="img-responsive" alt="Generic placeholder thumbnail"></a>
              <a href="/home/genappraisal/?pid={{ result.home3.id }}"><h4>{{ result.home3.address }}</h4></a>
              <span class="text-muted">Comparable #3<br>Last Sale Price: ${{result.home3.sale_price | intcomma}}</span>
            </div>
          </div> <!--images row-->
          
          
        <h2 class="sub-header" id="estimate_explanation">Estimate Explanation</h2>
        <p>
            EazyHouz Estimate is based on the comparable homes that have
            recently sold in the neighborhood. EazyHouz computes which homes are
            most similar using dozens of features including distance from the
            original home, bedrooms, square footage, age and more. The estimate
            is an average of the value of the closest comparable sales.
        </p>
        <div class="table-responsive"> <!--Estimate explanation table-->
            <table class="table table-striped" caption="This table explains how we came up with the home price estimate.">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Original</th>
                  <th>Comparable #1</th>
                  <th>Comparable #2</th>
                  <th>Comparable #3</th>
                </tr>
              </thead>
              <tbody>
                <tr class="info">
                  <td><b>Property Detail</b></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td> 
                </tr>
                <tr>
                  <td>Distance from Original (mi)</td>
                  <td>na</td>
                  <td>{{result.distance1|floatformat:"1"|intcomma}}</td>
                  <td>{{result.distance2|floatformat:"1"|intcomma}}</td>
                  <td>{{result.distance3|floatformat:"1"|intcomma}}</td> 
                </tr>
                <tr>
                  <td>Address</td>
                  <td>{{subject_home.address}}</td>
                  <td>{{result.home1.address}}</td>
                  <td>{{result.home2.address}}</td>
                  <td>{{result.home3.address}}</td>                  
                </tr>
                <tr>
                  <td>City</td>
                  <td>{{subject_home.city|title}}</td>
                  <td>{{result.home1.city|title}}</td>
                  <td>{{result.home2.city|title}}</td>
                  <td>{{result.home3.city|title}}</td>                  
                </tr>
                <tr>
                  <td>Zipcode</td>
                  <td>{{subject_home.zipcode}}</td>
                  <td>{{result.home1.zipcode}}</td>
                  <td>{{result.home2.zipcode}}</td>
                  <td>{{result.home3.zipcode}}</td> 
                </tr>
                <tr>
                  <td>Property Type</td>
                  <td>{{subject_home.property_type}}</td>
                  <td>{{result.home1.property_type}}</td>
                  <td>{{result.home2.property_type}}</td>
                  <td>{{result.home3.property_type}}</td> 
                </tr>             
                <tr>
                  <td>Beds</td>
                  <td>{{subject_home.beds}}</td>
                  <td>{{result.home1.beds}}</td>
                  <td>{{result.home2.beds}}</td>
                  <td>{{result.home3.beds}}</td> 
                </tr>
                <tr>
                  <td>Baths</td>
                  <td>{{subject_home.baths}}</td>
                  <td>{{result.home1.baths}}</td>
                  <td>{{result.home2.baths}}</td>
                  <td>{{result.home3.baths}}</td> 
                </tr>
                <tr>
                  <td>Sqft</td>
                  <td>{{subject_home.sqft |intcomma}}</td>
                  <td>{{result.home1.sqft |intcomma}}</td>
                  <td>{{result.home2.sqft|intcomma}}</td>
                  <td>{{result.home3.sqft|intcomma}}</td> 
                </tr>
                <tr>
                  <td>Lot Size</td>
                  <td>{{subject_home.lot_size |intcomma}}</td>
                  <td>{{result.home1.lot_size |intcomma}}</td>
                  <td>{{result.home2.lot_size|intcomma}}</td>
                  <td>{{result.home3.lot_size|intcomma}}</td> 
                </tr>
                <tr>
                  <td>Year Built</td>
                  <td>{{subject_home.year_built}}</td>
                  <td>{{result.home1.year_built}}</td>
                  <td>{{result.home2.year_built}}</td>
                  <td>{{result.home3.year_built}}</td> 
                </tr>
                <tr>
                  <td>Interior Rating</td>
                  <td>{{subject_home.interior_rating| intdiv:1 |floatformat:"0"|intcomma}}/5</td>
                  <td>{{result.home1.interior_rating| intdiv:1 |floatformat:"0"|intcomma}}/5</td>
                  <td>{{result.home2.interior_rating| intdiv:1 |floatformat:"0"|intcomma}}/5</td>
                  <td>{{result.home3.interior_rating| intdiv:1 |floatformat:"0"|intcomma}}/5</td> 
                </tr>
                <tr class="warning">
                  <td>Similarity Score</td>
                  <td>na</td>
                  <td>{{result.similarity1|intdiv:1 |floatformat:"0"|intcomma}}</td>
                  <td>{{result.similarity2|intdiv:1 |floatformat:"0"|intcomma}}</td>
                  <td>{{result.similarity3 | intdiv:1 |floatformat:"0"|intcomma}}</td> 
                </tr>                  
                <tr class="info">
                  <td><b>Valuation</b></td>
                  <td></td>
                  <td></td>
                  <td></td>
                  <td></td> 
                </tr>
              <br>
                <tr>
                  <td>Last Sale Date</td>
                  <td>{{subject_home.last_sale_date}}</td>
                  <td>{{result.home1.last_sale_date}}</td>
                  <td>{{result.home2.last_sale_date}}</td>
                  <td>{{result.home3.last_sale_date}}</td> 
                </tr>
                <tr>
                  <td>Last Sale Price</td>
                  <td>${{subject_home.sale_price | intcomma}}</td>
                  <td>${{result.home1.sale_price | intcomma}}</td>
                  <td>${{result.home2.sale_price | intcomma}}</td>
                  <td>${{result.home3.sale_price | intcomma}}</td>                  
                </tr>
                {% if result.home3.sale_price %} <!--to avoid an error if you are adding-->
                <tr>
                  <td>Sqft Adjustments</td>
                  <td>-</td>
                  <td>${{result.adjustment1.sqft | intdiv:1 |floatformat:"0"|intcomma}}</td>
                  <td>${{result.adjustment2.sqft | intdiv:1 |floatformat:"0"|intcomma}}</td>
                  <td>${{result.adjustment3.sqft | intdiv:1 |floatformat:"0"|intcomma}}</td>                  
                </tr>
                <tr>
                  <td>Other Adjustments</td>
                  <td>-</td>
                  <td>To come</td>
                  <td>To come</td>
                  <td>To come</td>
                </tr>
                <tr class="warning">
                  <td>Adjusted Home Values</td>
                  <td>-</td>
                  <td>${{result.adjustment1.sqft | add:result.home1.sale_price|intdiv:1 |floatformat:"0"|intcomma}}</td>
                  <td>${{result.adjustment2.sqft | add:result.home2.sale_price|intdiv:1 |floatformat:"0"|intcomma}}</td>
                  <td>${{result.adjustment3.sqft | add:result.home3.sale_price|intdiv:1 |floatformat:"0"|intcomma}}</td>                  
                </tr>
            {% endif %}
                <tr>
                  <td>Included in Average?</td>
                  <td>-</td>
                  <td>{{result.home1.comp_used }}</td>
                  <td>{{result.home2.comp_used }}</td>
                  <td>{{result.home3.comp_used }}</td>
                </tr>
              </tbody>
            </table>
          </div> <!-- end responsive table-->
        
         
         
         
        
        <h2 class="sub-header" id="recent_sales">Other Recent Sales</h2>
        <p>
            Know the values for a broader set of recent sales in the
            neighborhood. Ranked by our proprietary Similarity Score (higher is
            more similar). The average (at the top) give you an idea if
            the home is reasonably priced for its size, condition, and area. 
        </p>
        <div class="table-responsive"> <!--Recent sales table-->
        {% render_table recent_sales_table %}
        </div>
        
        
        
       

       
        

        <h2 class="sub-header" id="market_temp">Market Temperature*</h2>
        
        <p><strong>Extreme Seller's Market:</strong> more buyers are hunting for homes than there are homes to buy.</p>
        <br>
        <p><strong>Conditions:</strong> <ul>
            <li>Low inventory</li>
            <li>Increasing prices</li>
            <li>Fast moving homes</li>
            <li>Upward trendin sales volume</li>
            <li>Limited time bidding</li>
        </ul></p>

        
        <p><strong>Tips to give you an edge:</strong> <ul>
            <li>Get pre-approved</li>
            <li>Don't be demanding</li>
            <li>Don't expect a counteroffer</li>
            <li>Offer to close quickly</li>
            <li>Add a personal touch</li>
        </ul></p>        
        <h2 class="sub-header" id=foursquare>Foursquare within 1000m</h2>
        <p>
            Here's what people are checking into nearby sorted by our proprietary <u>Loyalty Score</u> which helps you understand how often people are coming back there.
        </p>
        {% render_table table %} <!--Foursquare view-->
        
        <h2 class="sub-header" id="yelp">Yelp within 1000m</h2>
        <p>
            Highly rated local businesses can make life pleasant and enhance your sense of community. Here's what people are Yelping about:
        </p>

           
        <div class="row list-group"> <!--Yelp view-->
            {% for r in yelp_r.businesses %}
            <div class="item  col-xs-3 col-lg-3" style="height:300px; overflow: auto;">
                <div class="img-responsive">
                    <img class="img-thumbnail" style="height: 175px" src="{{r.image_url}}" alt="{{r.snippet_text}}" />
                    <div class="caption">
                        <h4 class="group inner list-group-item-heading">
                            <a href="{{r.url}}">{{r.name}}</a> ({{r.distance|intdiv:1 |floatformat:"0"}} m)</h4>
                        <p class="group inner list-group-item-text">
                            {% for i in r.categories %}
                            {% with i|first as first_doc %}{{ first_doc }}{% endwith %}
                            {% endfor %}</p>
                        <div class="row">
                            
                            <div class="col-xs-12 col-md-12">
                                <p><img class="img-responsive" src="{{r.rating_img_url_large}}"></a>({{r.review_count}})</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>                        
            {% endfor %}                    
           
    

       


        
        
        </div>

        
                
        <h2 class="sub-header" id=instagram>Instagram posts within 1000m</h2>
        <p>
           More than any other factor, people define a neighborhood. Find out what your neighbors are like. Look for signs that neighbors share your interests in these Instagram photos taken within a 1,000m.
        </p>
        <div class="table-responsive"> <!--Instragram view-->
            <table class="table table-striped">
                <tbody>
                    {% for r in instagram_r %}
                        {% cycle '<tr>' '' '' '' %}
                        <td><a href="{{r.sri}}"><img data-src="holder.js/200x200" src="{{r.lri}}" class="img-thumbnail" alt="Instagram Img"></a></td>
                        {% cycle '' '' '' '</tr>' %}
                    {% endfor %}
                </tbody>
            </table>
        </div> <!--table div ends-->      
      
        
        <h2 class="sub-header" id=twitter>Recent Tweets</h2>
        <p>
           More than any other factor, people define a neighborhood. Find out what your neighbors are talking about on Twitter.
        </p>
        <div class="table-responsive"> <!--Twitter view-->
            <table class="table table-striped">
                <tbody>
                    {% for r in twitter_r %}
                        {% cycle '<tr>' '' '' '' %}
                        <td>{{ r }}</td>
                        {% cycle '' '' '' '</tr>' %}
                    {% endfor %}
                </tbody>
            </table>
        </div> <!--table div ends-->        

        <h2 class="sub-header" id="eventful">Events within 1000m</h2>
        <p>
           More than any other factor, people define a neighborhood. Find out kinds of events are being held in this community within a 1,000 meters.
        </p>
        <div class="row list-group"> <!--Eventful view-->
            {% for r in eventful_r %}
            <div class="item  col-xs-3 col-lg-3" style="height:300px; overflow: auto;">
                <div class="img-responsive">
                    <img class="img-thumbnail" style="height: 175px" src="{{r.image_url}}" alt="{{r.description}}" />
                    <div class="caption">
                        <h4 class="group inner list-group-item-heading">
                            <a href="{{r.url}}">{{r.title}}</a></h4>
                        <p class="group inner list-group-item-text">
                            {{ r.start_time }} <br> {{ r.calendar_count }}

                        <div class="row">

                        </div>
                    </div>
                </div>
            </div>                        
            {% endfor %}                    
        </div> <!--end alternate view-->
        
        </div>
    
        </div>
    </div>
    
       
        </div>
      </div>
    </div>
        
     
        
        
    </div>
</body>

    <script>
            $( document ).ready(function() {
            console.log("TEST1")
            $(".nav-sidebar li a[href^='#']").on('click', function(e) {
            console.log("TEST")
            // prevent default anchor click behavior
            e.preventDefault();
            
            // store hash
            $(".nav-sidebar li").removeClass("active");
            var hash = this.hash;
            $(this).parent().addClass("active");
            
            // animate
            $('html, body').animate({
            scrollTop: $(this.hash).offset().top-60
            }, 300, function(){
            
            
            // when done, add hash to url
            // (default click behaviour)
            window.location.hash = hash;
            });
            
            });//end nav element selector
            
            });//end document.ready
    </script>

{% endblock %}
